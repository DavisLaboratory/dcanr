<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical test for differential association analysis — dcTest • dcanr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical test for differential association analysis — dcTest"><meta property="og:description" content="Perform statistical tests for scores generated using
  dcScore. Selects appropriate tests for the different methods used
  in computing scores. The exact test is selected based on the scoring method
  used and cannot be manually specified. Available tests include the z-test
  and permutation tests. Parallel computation supported for the permutation
  test."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dcanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dcanr_evaluation_vignette.html">Evaluating differential co-expression methods using dcanr</a>
    </li>
    <li>
      <a href="../articles/dcanr_vignette.html">Performing differential co-expression analysis using dcanr</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisLaboratory/dcanr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical test for differential association analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/dcanr/blob/HEAD/R/statistical_tests.R" class="external-link"><code>R/statistical_tests.R</code></a></small>
    <div class="hidden name"><code>dcTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform statistical tests for scores generated using
  <code>dcScore</code>. Selects appropriate tests for the different methods used
  in computing scores. The exact test is selected based on the scoring method
  used and cannot be manually specified. Available tests include the z-test
  and permutation tests. Parallel computation supported for the permutation
  test.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dcTest</span><span class="op">(</span><span class="va">dcscores</span>, <span class="va">emat</span>, <span class="va">condition</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dcscores</dt>
<dd><p>a matrix, the result of the <code>dcScore</code> function. The
results should be passed as produced by the function and not modified in
intermediate steps</p></dd>


<dt>emat</dt>
<dd><p>a matrix, data.frame, ExpressionSet, SummarizedExperiment or
DGEList. This should be the one passed to <code>dcScore</code></p></dd>


<dt>condition</dt>
<dd><p>a numeric, (with 1's and 2's representing a binary
condition), a factor with 2 levels or a character representing 2
conditions. This should be the one passed to <code>dcScore</code></p></dd>


<dt>...</dt>
<dd><p>see details</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a matrix, of p-values (or scores in the case of DiffCoEx and
  EBcoexpress) representing significance of differential associations.
  DiffCoEx will return scores as the publication specifies direct
  thresholding of scores and EBcoexpress returns posterior probabilities.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Ensure that the score matrix passed to this function is the one
  produced by <code>dcScore</code>. Any modification to the result matrix will
  cause this function to fail. This is intended as the test need to be
  performed on the entire score matrix, not subsets.</p>
<p>The appropriate test is chosen automatically based on the scoring method
  used. A z-test is performed for the z-score method while no tests are
  performed for DiffCoEx, EBcoexpress and FTGI. Permutation tests are
  performed for the remainder of methods by permutation sample labels.
  Statistics from a permutation are pooled such that statistics from all
  scores are used to evaluate a single observed score.</p>
<p>Additional method specific parameters can be supplied to the function when
  performing permutation tests. <code>B</code> specifies the number of permutations
  to be performed and defaults to 20.</p>
<p>If a cluster exists, computation in a permutation test will be performed in
  parallel (see examples).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="dcMethods.html">dcMethods</a></code>, <code><a href="dcScore.html">dcScore</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="dcScore.html">dcScore</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cond</span>, dc.method <span class="op">=</span> <span class="st">'mindy'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dcTest</span><span class="op">(</span><span class="va">scores</span>, emat <span class="op">=</span> <span class="va">x</span>, condition <span class="op">=</span> <span class="va">cond</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>executing %dopar% sequentially: no parallel backend registered</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: foreach</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: rngtools</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 NA  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"call")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mindy.score(emat = emat, condition = condition)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"dc.method")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mindy"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"dc.test")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "permutation"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#running in parallel</span></span></span>
<span class="r-in"><span><span class="va">num_cores</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">num_cores</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">doSNOW</span><span class="fu">::</span><span class="fu">registerDoSNOW</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span> <span class="co">#or doParallel</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">36</span><span class="op">)</span> <span class="co">#for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu">dcTest</span><span class="op">(</span><span class="va">scores</span>, emat <span class="op">=</span> <span class="va">x</span>, condition <span class="op">=</span> <span class="va">cond</span>, B <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dharmesh D. Bhuva.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

