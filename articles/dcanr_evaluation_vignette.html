<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating differential co-expression methods using dcanr • dcanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating differential co-expression methods using dcanr">
<meta property="og:description" content="dcanr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dcanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dcanr_evaluation_vignette.html">Evaluating differential co-expression methods using dcanr</a>
    </li>
    <li>
      <a href="../articles/dcanr_vignette.html">Performing differential co-expression analysis using dcanr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisLaboratory/dcanr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Evaluating differential co-expression methods
using dcanr</h1>
                        <h4 data-toc-skip class="author">Dharmesh D
Bhuva</h4>
            <address class="author_afil">
      Bioinformatics Division, Walter and Eliza Hall Institute of
Medical Research, Parkville, VIC 3052, AustraliaSchool of Mathematics
and Statistics, University of Melbourne, Parkville, VIC 3010,
Australia<br><h4 data-toc-skip class="date">2022-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/dcanr/blob/HEAD/vignettes/dcanr_evaluation_vignette.Rmd" class="external-link"><code>vignettes/dcanr_evaluation_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>dcanr_evaluation_vignette.Rmd</code></div>

    </address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Along with implementations for several differential co-expression
analysis methods, this package provides an evaluation framework to
benchmark methods. Real data are rarely available for the evaluation of
differential co-expression methods as such experiments are difficult to
perform and in almost all cases, the true/gold-standard network is
unknown. As such, simulations are the only means to perform a rigorous
comparison and evaluation. Data from 812 simulations were generated with
settings and parameters are described in <strong>Bhuva et al.
(manuscript in preparation)</strong> and results included here. Along
with the data, a suite of visualisation and performance metrics are
implemented.</p>
<p>This vignette describes functions in this package that enable
comparative evaluation of inference methods. All methods implemented in
the package can be evaluated and novel methods can be integrated into
the evaluation framework with relative ease.</p>
</div>
<div class="section level2">
<h2 id="simulation-setup-used-to-create-the-data">Simulation setup used to create the data<a class="anchor" aria-label="anchor" href="#simulation-setup-used-to-create-the-data"></a>
</h2>
<p>A dynamical systems simulator was used to generate synthetic
expression data with differential associations. Regulatory networks of
150 genes were sampled from a <em>S. cerevisiae</em> regulatory network.
Perturbation experiments were performed when simulating data to induce
differential associations. Simulation parameters and networks were
sampled to produce 812 distinct simulations. The dataset included in
dcanr, <code>sim102</code>, is an example of one such simulation. Two
knock-downs were performed simultaneously but independent of each other,
therefore, some samples may have both knock-downs while other may have
either one or none. Details on the simulation procedure can be found in
the <strong>Bhuva et al. (manuscript in preparation)</strong>. Up to 500
observations are sampled in each simulation.</p>
</div>
<div class="section level2">
<h2 id="download-the-full-simulated-dataset">Download the full simulated dataset<a class="anchor" aria-label="anchor" href="#download-the-full-simulated-dataset"></a>
</h2>
<p>As the simulation is computationally intensive, data from the 812
simulations have been precomputed and are available at <a href="https://melbourne.figshare.com/articles/812_simulated_expression_datasets_for_differential_co-expression_analysis/8010176" class="external-link uri">https://melbourne.figshare.com/articles/812_simulated_expression_datasets_for_differential_co-expression_analysis/8010176</a>.
The downloaded file contains a list of simulation results which includes
<code>sim102</code>, packaged with <code>dcanr</code>. Each simulation
can be accessed as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Not evaluated</span></span>
<span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">'simdata_directory/sim812.rds'</span><span class="op">)</span></span>
<span><span class="va">sim10</span> <span class="op">&lt;-</span> <span class="va">simdata</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-a-pipeline-on-a-simulation">Running a pipeline on a simulation<a class="anchor" aria-label="anchor" href="#running-a-pipeline-on-a-simulation"></a>
</h2>
<p>Evaluations in the package are performed by creating an analysis
pipeline and packaging this into a function. Three possible ways exist
to perform this:</p>
<ol style="list-style-type: decimal">
<li>Using standard in-built pipelines</li>
<li>Using custom pipelines</li>
<li>Retrieving pre-computed results from the standard pipelines</li>
</ol>
<p>All of the above are made possible using a single function
<code>dcPipeline</code> and are processed depending on the arguments
specified.</p>
<div class="section level3">
<h3 id="standard-pipelines">Standard pipelines<a class="anchor" aria-label="anchor" href="#standard-pipelines"></a>
</h3>
<p>A standard pipeline runs the in-built inference methods with their
default parameters. All 4 steps of an analysis are performed in sequence
as described in their respective publications. To run a standard
pipeline on a simulation, simply pass in a simulation and a method name
from <code><a href="../reference/dcMethods.html">dcMethods()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davislaboratory.github.io/dcanr/" class="external-link">dcanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#load the data: a simulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim102</span><span class="op">)</span> </span>
<span><span class="co">#run a standard pipeline with the z-score method</span></span>
<span><span class="va">dcnets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcPipeline.html">dcPipeline</a></span><span class="op">(</span><span class="va">sim102</span>, dc.func <span class="op">=</span> <span class="st">'zscore'</span><span class="op">)</span></span>
<span><span class="co">#plot the source network, true differential network and inferred networks</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSimNetwork.html">plotSimNetwork</a></span><span class="op">(</span><span class="va">sim102</span>, main <span class="op">=</span> <span class="st">'Regulatory network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSimNetwork.html">plotSimNetwork</a></span><span class="op">(</span><span class="va">sim102</span>, what <span class="op">=</span> <span class="st">'association'</span>, main <span class="op">=</span> <span class="st">'True differential association network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dcnets</span><span class="op">$</span><span class="va">ADR1</span>, main <span class="op">=</span> <span class="st">'ADR1 KD predicted network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dcnets</span><span class="op">$</span><span class="va">UME6</span>, main <span class="op">=</span> <span class="st">'UME6 KD predicted network'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="dcanr_evaluation_vignette_files/figure-html/unnamed-chunk-2-1.png" alt="Differential network analysis on simulations. Top-left to bottom-right: The original regulatory network used for simulations; the true induced differential network that results from both ADR1 and UME6 knock-downs (KDs); the predicted ADR1 knock-down differential network, and; the predicted UME6 knock-down differential network. Reg and green edges in the regulatory network represent activation and repression respectively. Edges in the differential network are coloured based on the knock-down that results in their differential co-expression. True positives in the predicted network are coloured based on their knock-down while false positives are coloured grey" width="700"><p class="caption">
Differential network analysis on simulations. Top-left to bottom-right:
The original regulatory network used for simulations; the true induced
differential network that results from both ADR1 and UME6 knock-downs
(KDs); the predicted ADR1 knock-down differential network, and; the
predicted UME6 knock-down differential network. Reg and green edges in
the regulatory network represent activation and repression respectively.
Edges in the differential network are coloured based on the knock-down
that results in their differential co-expression. True positives in the
predicted network are coloured based on their knock-down while false
positives are coloured grey
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p>Results from a pipeline are provided as a list of <code>igraph</code>
objects representing the inferred networks, one for each knock-down.
True positive predictions are coloured based on the colour of the
knocked-down node and false positives are coloured grey. The
<code>plotSimNetwork</code> function can be used to retrieve and plot
the true differential networks and the source regulatory network.</p>
<p>Any additional parameters for intermediate steps in a standard
pipeline can be passed as shown in the example below. However, doing so
will produce results different from the precomputed results discussed in
(Section @ref(precomp)).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#run a standard pipeline with the z-score method with custom params</span></span>
<span><span class="va">dcnets_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcPipeline.html">dcPipeline</a></span><span class="op">(</span><span class="va">sim102</span>,</span>
<span>                        dc.func <span class="op">=</span> <span class="st">'zscore'</span>,</span>
<span>                        cor.method <span class="op">=</span> <span class="st">'spearman'</span>, <span class="co">#use Spearman's correlation</span></span>
<span>                        thresh <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co">#cut-off for creating the network</span></span></code></pre></div>
<p>If the parameters need to be specified for each condition, the
<code>cond.args</code> argument can be used. For example, the LDGM
method requires the regularisation parameter to be specified for each
condition. Since <code>sim102</code> has 2 conditions
(<em>ADR1</em>-knockdown and <em>UME6</em>-knockdown),
<code>ldgm.lambda</code> needs to be specified for each case.
Alternatively, the number of edges in the DC network resulting from each
condition can be passed using <code>ldgm.ntarget</code> in
<code>cond.args</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim102_lambdas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5145742607781790267651</span>, <span class="fl">0.3486682118540171959609</span><span class="op">)</span></span>
<span><span class="va">dcnets_ldgm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcPipeline.html">dcPipeline</a></span><span class="op">(</span><span class="va">sim102</span>,</span>
<span>                          dc.func <span class="op">=</span> <span class="st">'ldgm'</span>,</span>
<span>                          cond.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                            ldgm.lambda <span class="op">=</span> <span class="va">sim102_lambdas</span></span>
<span>                          <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-pipelines">Custom pipelines<a class="anchor" aria-label="anchor" href="#custom-pipelines"></a>
</h3>
<p>The most common use case of an evaluation framework is to benchmark
new methods. As such, this framework allows seamless integration of new
methods. This is made possible in <code>dcanr</code> by providing a
single function to the <code>dcPipeline</code> method. This function
should follow the skeleton below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#emat, a named matrix with samples along the columns and genes along the rows</span></span>
<span><span class="co">#condition, a binary named vector consisiting of 1's and 2's</span></span>
<span><span class="co">#returns a named adjacency matrix or an igraph object</span></span>
<span><span class="va">myInference</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">emat</span>, <span class="va">condition</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#your code here</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">dcnet</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The following code shows the function used to call an in-built
pipeline and how a custom pipeline can be run.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#custom pipeline function</span></span>
<span><span class="va">analysisInbuilt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">emat</span>, <span class="va">condition</span>, <span class="va">dc.method</span> <span class="op">=</span> <span class="st">'zscore'</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#compute scores</span></span>
<span>  <span class="va">score</span> <span class="op">=</span> <span class="fu"><a href="../reference/dcScore.html">dcScore</a></span><span class="op">(</span><span class="va">emat</span>, <span class="va">condition</span>, <span class="va">dc.method</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="co">#perform statistical test</span></span>
<span>  <span class="va">pvals</span> <span class="op">=</span> <span class="fu"><a href="../reference/dcTest.html">dcTest</a></span><span class="op">(</span><span class="va">score</span>, <span class="va">emat</span>, <span class="va">condition</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="co">#adjust tests for multiple testing</span></span>
<span>  <span class="va">adjp</span> <span class="op">=</span> <span class="fu"><a href="../reference/dcAdjust.html">dcAdjust</a></span><span class="op">(</span><span class="va">pvals</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="co">#threshold and generate network</span></span>
<span>  <span class="va">dcnet</span> <span class="op">=</span> <span class="fu"><a href="../reference/dcNetwork.html">dcNetwork</a></span><span class="op">(</span><span class="va">score</span>, <span class="va">adjp</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">dcnet</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#call the custom pipeline</span></span>
<span><span class="va">custom_nets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcPipeline.html">dcPipeline</a></span><span class="op">(</span><span class="va">sim102</span>, dc.func <span class="op">=</span> <span class="va">analysisInbuilt</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="precomp">Retrieving pre-computed results<a class="anchor" aria-label="anchor" href="#precomp"></a>
</h3>
<p>Following evaluation of a novel method, it is generally of interest
to compare how it performs against previous methods. Re-computing
predictions for the 10 methods implemented in this package can be time
consuming. As such, all simulations come packaged with results from
applying a standard pipeline using each inference method. Pre-computed
results are also retrieved using the <code>dcPipeline</code> function,
with the <code>precomputed</code> argument set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#retrieve results of applying all available methods</span></span>
<span><span class="va">allnets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/dcMethods.html">dcMethods</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dcPipeline.html">dcPipeline</a></span><span class="op">(</span><span class="va">sim102</span>, dc.func <span class="op">=</span> <span class="va">m</span>, precomputed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">allnets</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcMethods.html">dcMethods</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#name the results based on methods</span></span>
<span></span>
<span><span class="co">#get the size of the UME6 KD differential network</span></span>
<span><span class="va">netsizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">allnets</span>, <span class="kw">function</span><span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">UME6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">netsizes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       dicer    diffcoex ebcoexpress     entropy        ftgi   ggm-based </span></span>
<span><span class="co">##         119         175        2914         351           8           0 </span></span>
<span><span class="co">##        ldgm       magic       mindy      zscore </span></span>
<span><span class="co">##          42          46          27          91</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="evaluate-a-pipeline">Evaluate a pipeline<a class="anchor" aria-label="anchor" href="#evaluate-a-pipeline"></a>
</h2>
<p>After inferring the differential co-expression network, the final
step is to evaluate performance based on the truth. True differential
networks are computed by performing a sensitivity analysis as described
in the <strong>Bhuva et al. (manuscript in preparation)</strong>. Three
levels of true differential networks are generated:</p>
<ol style="list-style-type: decimal">
<li>Direct - this represents direct TF-target regulatory interactions
that are affected by the knock-down (condition)</li>
<li>Influence - this network includes upstream TF-target interactions
which are indirect but causative</li>
<li>Association - this network includes all associations in the
influence network but adds all non-causative associations that are
differential when conditioned on the knock-down</li>
</ol>
<p>All three levels of truth are included within the simulated data.
Predicted networks can be evaluated against any of these. We recommend
using the differential association network.</p>
<p>Along with the true differential co-expression network, a metric is
required to summarise performance of a method. The package provides 6
different metrics which can be accessed by calling
<code><a href="../reference/perfMethods.html">perfMethods()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#available performance metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/perfMethods.html">perfMethods</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "AC"        "accuracy"  "f.measure" "MCC"       "precision" "recall"</span></span></code></pre>
<p>Evaluation is performed using the <code>dcEvaluate</code> function.
We will run this with the precomputed inferences as described in
(Section @ref(precomp)). The F1-measure will be computed to assess
performance.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute the F1-measure for the prediction made by each method</span></span>
<span><span class="va">f1_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">allnets</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span><span class="op">(</span><span class="va">sim102</span>, <span class="va">net</span>, truth.type <span class="op">=</span> <span class="st">'association'</span>, combine <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">f1_scores</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     entropy      zscore        ftgi    diffcoex       dicer        ldgm </span></span>
<span><span class="co">##  0.69625247  0.56259660  0.43928571  0.37606838  0.35130435  0.27777778 </span></span>
<span><span class="co">##       mindy       magic ebcoexpress   ggm-based </span></span>
<span><span class="co">##  0.23625255  0.11428571  0.01183932  0.00000000</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute the Matthew's correlation coefficient of the z-score inference</span></span>
<span><span class="va">z_mcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span><span class="op">(</span><span class="va">sim102</span>, <span class="va">dcnets</span>, perf.method <span class="op">=</span> <span class="st">'MCC'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">z_mcc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5761074</span></span></code></pre>
<p>These metrics can be combined to learn more about the advantages and
limitations of different methods. For instance, the precision and recall
characteristics of the different methods can be computed. For sim102,
this shows that the entropy-based method excels at recall while the
z-score based method has high precision.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute precision</span></span>
<span><span class="va">dcprec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">allnets</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span><span class="op">(</span><span class="va">sim102</span>, <span class="va">net</span>, perf.method <span class="op">=</span> <span class="st">'precision'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#compute recall</span></span>
<span><span class="va">dcrecall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">allnets</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span><span class="op">(</span><span class="va">sim102</span>, <span class="va">net</span>, perf.method <span class="op">=</span> <span class="st">'recall'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><img src="dcanr_evaluation_vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] dcanr_1.13.8     BiocStyle_2.25.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] highr_0.9           RColorBrewer_1.1-3  bslib_0.4.0        </span></span>
<span><span class="co">##  [4] compiler_4.2.1      BiocManager_1.30.18 jquerylib_0.1.4    </span></span>
<span><span class="co">##  [7] iterators_1.0.14    tools_4.2.1         rngtools_1.5.2     </span></span>
<span><span class="co">## [10] digest_0.6.29       lattice_0.20-45     jsonlite_1.8.2     </span></span>
<span><span class="co">## [13] evaluate_0.17       memoise_2.0.1       pkgconfig_2.0.3    </span></span>
<span><span class="co">## [16] rlang_1.0.6         doRNG_1.8.2         Matrix_1.5-1       </span></span>
<span><span class="co">## [19] foreach_1.5.2       igraph_1.3.5        cli_3.4.1          </span></span>
<span><span class="co">## [22] yaml_2.3.5          parallel_4.2.1      pkgdown_2.0.6.9000 </span></span>
<span><span class="co">## [25] xfun_0.33           fastmap_1.1.0       stringr_1.4.1      </span></span>
<span><span class="co">## [28] knitr_1.40          desc_1.4.2          fs_1.5.2           </span></span>
<span><span class="co">## [31] sass_0.4.2          GlobalOptions_0.1.2 systemfonts_1.0.4  </span></span>
<span><span class="co">## [34] grid_4.2.1          rprojroot_2.0.3     R6_2.5.1           </span></span>
<span><span class="co">## [37] textshaping_0.3.6   rmarkdown_2.17      bookdown_0.29      </span></span>
<span><span class="co">## [40] purrr_0.3.5         magrittr_2.0.3      codetools_0.2-18   </span></span>
<span><span class="co">## [43] htmltools_0.5.3     shape_1.4.6         colorspace_2.0-3   </span></span>
<span><span class="co">## [46] circlize_0.4.15     ragg_1.2.3          stringi_1.7.8      </span></span>
<span><span class="co">## [49] cachem_1.0.6</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dharmesh D. Bhuva.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
