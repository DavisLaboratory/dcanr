<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating differential co-expression methods using dcanr â€¢ dcanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating differential co-expression methods using dcanr">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dcanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dcanr_vignette.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dcanr_evaluation_vignette.html">Evaluating differential co-expression methods using dcanr</a>
    </li>
    <li>
      <a href="../articles/dcanr_vignette.html">Performing differential co-expression analysis using dcanr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisLaboratory/dcanr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Evaluating differential co-expression methods using dcanr</h1>
                        <h4 class="author">Dharmesh D Bhuva</h4>
            <address class="author_afil">
      Bioinformatics Division, Walter and Eliza Hall Institute of Medical Research, Parkville, VIC 3052, Australia<br><h4 class="date">2019-08-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/dcanr/blob/master/vignettes/dcanr_evaluation_vignette.Rmd"><code>vignettes/dcanr_evaluation_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>dcanr_evaluation_vignette.Rmd</code></div>

    </address>
</div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Along with implementations for several differential co-expression analysis methods, this package provides an evaluation framework to benchmark methods. Real data are rarely available for the evaluation of differential co-expression methods as such experiments are difficult to perform and in almost all cases, the true/gold-standard network is unknown. As such, simulations are the only means to perform a rigorous comparison and evaluation. Data from 812 simulations were generated with settings and parameters are described in <strong>Bhuva et al. (manuscript in preparation)</strong> and results included here. Along with the data, a suite of visualisation and performance metrics are implemented.</p>
<p>This vignette describes functions in this package that enable comparative evaluation of inference methods. All methods implemented in the package can be evaluated and novel methods can be integrated into the evaluation framework with relative ease.</p>
</div>
<div id="simulation-setup-used-to-create-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-setup-used-to-create-the-data" class="anchor"></a>Simulation setup used to create the data</h1>
<p>A dynamical systems simulator was used to generate synthetic expression data with differential associations. Regulatory networks of 150 genes were sampled from a <em>S. cerevisiae</em> regulatory network. Perturbation experiments were performed when simulating data to induce differential associations. Simulation parameters and networks were sampled to produce 812 distinct simulations. The dataset included in dcanr, <code>sim102</code>, is an example of one such simulation. Two knock-downs were performed simultaneously but independent of each other, therefore, some samples may have both knock-downs while other may have either one or none. Details on the simulation procedure can be found in the <strong>Bhuva et al. (manuscript in preparation)</strong>. Up to 500 observations are sampled in each simulation.</p>
</div>
<div id="download-the-full-simulated-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#download-the-full-simulated-dataset" class="anchor"></a>Download the full simulated dataset</h1>
<p>As the simulation is computationally intensive, data from the 812 simulations have been precomputed and are available at <a href="https://melbourne.figshare.com/articles/812_simulated_expression_datasets_for_differential_co-expression_analysis/8010176" class="uri">https://melbourne.figshare.com/articles/812_simulated_expression_datasets_for_differential_co-expression_analysis/8010176</a>. The downloaded file contains a list of simulation results which includes <code>sim102</code>, packaged with <code>dcanr</code>. Each simulation can be accessed as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#Not evaluated</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">simdata &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRDS">readRDS</a></span>(<span class="st">'simdata_directory/sim812.rds'</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">sim10 &lt;-<span class="st"> </span>simdata[[<span class="dv">10</span>]]</a></code></pre></div>
</div>
<div id="running-a-pipeline-on-a-simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#running-a-pipeline-on-a-simulation" class="anchor"></a>Running a pipeline on a simulation</h1>
<p>Evaluations in the package are performed by creating an analysis pipeline and packaging this into a function. Three possible ways exist to perform this:</p>
<ol style="list-style-type: decimal">
<li>Using standard in-built pipelines</li>
<li>Using custom pipelines</li>
<li>Retrieving pre-computed results from the standard pipelines</li>
</ol>
<p>All of the above are made possible using a single function <code>dcPipeline</code> and are processed depending on the arguments specified.</p>
<div id="standard-pipelines" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-pipelines" class="anchor"></a>Standard pipelines</h2>
<p>A standard pipeline runs the in-built inference methods with their default parameters. All 4 steps of an analysis are performed in sequence as described in their respective publications. To run a standard pipeline on a simulation, simply pass in a simulation and a method name from <code><a href="../reference/dcMethods.html">dcMethods()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dcanr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#load the data: a simulation</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sim102) </a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#run a standard pipeline with the z-score method</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">dcnets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcPipeline.html">dcPipeline</a></span>(sim102, <span class="dt">dc.func =</span> <span class="st">'zscore'</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#plot the source network, true differential network and inferred networks</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">op &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw"><a href="../reference/plotSimNetwork.html">plotSimNetwork</a></span>(sim102, <span class="dt">main =</span> <span class="st">'Regulatory network'</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw"><a href="../reference/plotSimNetwork.html">plotSimNetwork</a></span>(sim102, <span class="dt">what =</span> <span class="st">'association'</span>, <span class="dt">main =</span> <span class="st">'True differential association network'</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(dcnets<span class="op">$</span>ADR1, <span class="dt">main =</span> <span class="st">'ADR1 KD predicted network'</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(dcnets<span class="op">$</span>UME6, <span class="dt">main =</span> <span class="st">'UME6 KD predicted network'</span>)</a></code></pre></div>
<div class="figure">
<img src="dcanr_evaluation_vignette_files/figure-html/unnamed-chunk-2-1.png" alt="Differential network analysis on simulations. Top-left to bottom-right: The original regulatory network used for simulations; the true induced differential network that results from both ADR1 and UME6 knock-downs (KDs); the predicted ADR1 knock-down differential network, and; the predicted UME6 knock-down differential network. Reg and green edges in the regulatory network represent activation and repression respectively. Edges in the differential network are coloured based on the knock-down that results in their differential co-expression. True positives in the predicted network are coloured based on their knock-down while false positives are coloured grey" width="700"><p class="caption">
Differential network analysis on simulations. Top-left to bottom-right: The original regulatory network used for simulations; the true induced differential network that results from both ADR1 and UME6 knock-downs (KDs); the predicted ADR1 knock-down differential network, and; the predicted UME6 knock-down differential network. Reg and green edges in the regulatory network represent activation and repression respectively. Edges in the differential network are coloured based on the knock-down that results in their differential co-expression. True positives in the predicted network are coloured based on their knock-down while false positives are coloured grey
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(op)</a></code></pre></div>
<p>Results from a pipeline are provided as a list of <code>igraph</code> objects representing the inferred networks, one for each knock-down. True positive predictions are coloured based on the colour of the knocked-down node and false positives are coloured grey. The <code>plotSimNetwork</code> function can be used to retrieve and plot the true differential networks and the source regulatory network.</p>
<p>Any additional parameters for intermediate steps in a standard pipeline can be passed as shown in the example below. However, doing so will produce results different from the precomputed results discussed in (Section @ref(precomp)).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#run a standard pipeline with the z-score method with custom params</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">dcnets_sp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcPipeline.html">dcPipeline</a></span>(sim102,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                        <span class="dt">dc.func =</span> <span class="st">'zscore'</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                        <span class="dt">cor.method =</span> <span class="st">'spearman'</span>, <span class="co">#use Spearman's correlation</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                        <span class="dt">thresh =</span> <span class="fl">0.2</span>) <span class="co">#cut-off for creating the network</span></a></code></pre></div>
<p>If the parameters need to be specified for each condition, the <code>cond.args</code> argument can be used. For example, the LDGM method requires the regularisation parameter to be specified for each condition. Since <code>sim102</code> has 2 conditions (<em>ADR1</em>-knockdown and <em>UME6</em>-knockdown), <code>ldgm.lambda</code> needs to be specified for each case. Alternatively, the number of edges in the DC network resulting from each condition can be passed using <code>ldgm.ntarget</code> in <code>cond.args</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">sim102_lambdas =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5145742607781790267651</span>, <span class="fl">0.3486682118540171959609</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">dcnets_ldgm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcPipeline.html">dcPipeline</a></span>(sim102,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                          <span class="dt">dc.func =</span> <span class="st">'ldgm'</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                          <span class="dt">cond.args =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                            <span class="dt">ldgm.lambda =</span> sim102_lambdas</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                          ))</a></code></pre></div>
</div>
<div id="custom-pipelines" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-pipelines" class="anchor"></a>Custom pipelines</h2>
<p>The most common use case of an evaluation framework is to benchmark new methods. As such, this framework allows seamless integration of new methods. This is made possible in <code>dcanr</code> by providing a single function to the <code>dcPipeline</code> method. This function should follow the skeleton below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#emat, a named matrix with samples along the columns and genes along the rows</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#condition, a binary named vector consisiting of 1's and 2's</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#returns a named adjacency matrix or an igraph object</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">myInference &lt;-<span class="st"> </span><span class="cf">function</span>(emat, condition, ...) {</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="co">#your code here</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(dcnet)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">}</a></code></pre></div>
<p>The following code shows the function used to call an in-built pipeline and how a custom pipeline can be run.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#custom pipeline function</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">analysisInbuilt &lt;-<span class="st"> </span><span class="cf">function</span>(emat, condition, <span class="dt">dc.method =</span> <span class="st">'zscore'</span>, ...) {</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="co">#compute scores</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  score =<span class="st"> </span><span class="kw"><a href="../reference/dcScore.html">dcScore</a></span>(emat, condition, dc.method, ...)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="co">#perform statistical test</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  pvals =<span class="st"> </span><span class="kw"><a href="../reference/dcTest.html">dcTest</a></span>(score, emat, condition, ...)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="co">#adjust tests for multiple testing</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  adjp =<span class="st"> </span><span class="kw"><a href="../reference/dcAdjust.html">dcAdjust</a></span>(pvals, ...)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  <span class="co">#threshold and generate network</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  dcnet =<span class="st"> </span><span class="kw"><a href="../reference/dcNetwork.html">dcNetwork</a></span>(score, adjp, ...)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(dcnet)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#call the custom pipeline</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">custom_nets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcPipeline.html">dcPipeline</a></span>(sim102, <span class="dt">dc.func =</span> analysisInbuilt)</a></code></pre></div>
</div>
<div id="precomp" class="section level2">
<h2 class="hasAnchor">
<a href="#precomp" class="anchor"></a>Retrieving pre-computed results</h2>
<p>Following evaluation of a novel method, it is generally of interest to compare how it performs against previous methods. Re-computing predictions for the 10 methods implemented in this package can be time consuming. As such, all simulations come packaged with results from applying a standard pipeline using each inference method. Pre-computed results are also retrieved using the <code>dcPipeline</code> function, with the <code>precomputed</code> argument set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#retrieve results of applying all available methods</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">allnets &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="kw"><a href="../reference/dcMethods.html">dcMethods</a></span>(), <span class="cf">function</span>(m) {</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw"><a href="../reference/dcPipeline.html">dcPipeline</a></span>(sim102, <span class="dt">dc.func =</span> m, <span class="dt">precomputed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(allnets) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcMethods.html">dcMethods</a></span>() <span class="co">#name the results based on methods</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#get the size of the UME6 KD differential network</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">netsizes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(allnets, <span class="cf">function</span>(net) {</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(igraph<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net<span class="op">$</span>UME6))</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">})</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(netsizes))</a></code></pre></div>
<pre><code>##       dicer    diffcoex ebcoexpress         ecf     entropy        ftgi 
##         119         175        2914        1979         351           8 
##   ggm-based        ldgm       magic       mindy      zscore 
##           0          42          46          27          91</code></pre>
</div>
</div>
<div id="evaluate-a-pipeline" class="section level1">
<h1 class="hasAnchor">
<a href="#evaluate-a-pipeline" class="anchor"></a>Evaluate a pipeline</h1>
<p>After inferring the differential co-expression network, the final step is to evaluate performance based on the truth. True differential networks are computed by performing a sensitivity analysis as described in the <strong>Bhuva et al. (manuscript in preparation)</strong>. Three levels of true differential networks are generated:</p>
<ol style="list-style-type: decimal">
<li>Direct - this represents direct TF-target regulatory interactions that are affected by the knock-down (condition)</li>
<li>Influence - this network includes upstream TF-target interactions which are indirect but causative</li>
<li>Association - this network includes all associations in the influence network but adds all non-causative associations that are differential when conditioned on the knock-down</li>
</ol>
<p>All three levels of truth are included within the simulated data. Predicted networks can be evaluated against any of these. We recommend using the differential association network.</p>
<p>Along with the true differential co-expression network, a metric is required to summarise performance of a method. The package provides 6 different metrics which can be accessed by calling <code><a href="../reference/perfMethods.html">perfMethods()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#available performance metrics</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="../reference/perfMethods.html">perfMethods</a></span>())</a></code></pre></div>
<pre><code>## [1] "AC"        "accuracy"  "f.measure" "MCC"       "precision" "recall"</code></pre>
<p>Evaluation is performed using the <code>dcEvaluate</code> function. We will run this with the precomputed inferences as described in (Section @ref(precomp)). The F1-measure will be computed to assess performance.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#compute the F1-measure for the prediction made by each method</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">f1_scores &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(allnets, <span class="cf">function</span> (net) {</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  <span class="kw"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span>(sim102, net, <span class="dt">truth.type =</span> <span class="st">'association'</span>, <span class="dt">combine =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(f1_scores), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>##     entropy      zscore        ftgi    diffcoex       dicer        ldgm 
##  0.69625247  0.56259660  0.43928571  0.37606838  0.35130435  0.27777778 
##         ecf       mindy       magic ebcoexpress   ggm-based 
##  0.24793388  0.23625255  0.11428571  0.01183932  0.00000000</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">#compute the Matthew's correlation coefficient of the z-score inference</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">z_mcc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span>(sim102, dcnets, <span class="dt">perf.method =</span> <span class="st">'MCC'</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(z_mcc)</a></code></pre></div>
<pre><code>## [1] 0.5761074</code></pre>
<p>These metrics can be combined to learn more about the advantages and limitations of different methods. For instance, the precision and recall characteristics of the different methods can be computed. For sim102, this shows that the entropy-based method excels at recall while the z-score based method has high precision.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#compute precision</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">dcprec &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(allnets, <span class="cf">function</span> (net) {</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="kw"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span>(sim102, net, <span class="dt">perf.method =</span> <span class="st">'precision'</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#compute recall</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">dcrecall &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(allnets, <span class="cf">function</span> (net) {</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="kw"><a href="../reference/dcEvaluate.html">dcEvaluate</a></span>(sim102, net, <span class="dt">perf.method =</span> <span class="st">'recall'</span>)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">})</a></code></pre></div>
<p><img src="dcanr_evaluation_vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: CentOS Linux 7 (Core)
## 
## Matrix products: default
## BLAS:   /stornext/System/data/apps/R/R-3.6.1/lib64/R/lib/libRblas.so
## LAPACK: /stornext/System/data/apps/R/R-3.6.1/lib64/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] dcanr_1.1.4      BiocStyle_2.12.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.1          highr_0.8           RColorBrewer_1.1-2 
##  [4] compiler_3.6.1      BiocManager_1.30.4  iterators_1.0.10   
##  [7] tools_3.6.1         rngtools_1.4        digest_0.6.20      
## [10] lattice_0.20-38     evaluate_0.14       memoise_1.1.0      
## [13] pkgconfig_2.0.2     rlang_0.4.0         doRNG_1.7.1        
## [16] Matrix_1.2-17       foreach_1.4.4       bibtex_0.4.2       
## [19] igraph_1.2.4.1      registry_0.5-1      rstudioapi_0.10    
## [22] commonmark_1.7      yaml_2.2.0          parallel_3.6.1     
## [25] pkgdown_1.3.0       xfun_0.8            withr_2.1.2        
## [28] stringr_1.4.0       pkgmaker_0.27       roxygen2_6.1.1     
## [31] xml2_1.2.0          knitr_1.23          GlobalOptions_0.1.0
## [34] desc_1.2.0          fs_1.3.1            grid_3.6.1         
## [37] rprojroot_1.3-2     R6_2.4.0            rmarkdown_1.13     
## [40] bookdown_0.11       magrittr_1.5        backports_1.1.4    
## [43] codetools_0.2-16    htmltools_0.3.6     MASS_7.3-51.4      
## [46] assertthat_0.2.1    shape_1.4.4         colorspace_1.4-1   
## [49] circlize_0.4.6      xtable_1.8-4        stringi_1.4.3      
## [52] crayon_1.3.4</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simulation-setup-used-to-create-the-data">Simulation setup used to create the data</a></li>
      <li><a href="#download-the-full-simulated-dataset">Download the full simulated dataset</a></li>
      <li>
<a href="#running-a-pipeline-on-a-simulation">Running a pipeline on a simulation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#standard-pipelines">Standard pipelines</a></li>
      <li><a href="#custom-pipelines">Custom pipelines</a></li>
      <li><a href="#precomp">Retrieving pre-computed results</a></li>
      </ul>
</li>
      <li><a href="#evaluate-a-pipeline">Evaluate a pipeline</a></li>
      <li><a href="#session-info">Session info</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dharmesh D. Bhuva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
